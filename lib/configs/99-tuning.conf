# --- 1. General System & Memory Management ---
fs.file-max = 500000
vm.swappiness = 10
vm.vfs_cache_pressure = 50

# --- 2. Port & Connection Limits ---
net.ipv4.ip_local_port_range = 1024 65535
net.core.somaxconn = 2048
net.core.netdev_max_backlog = 5000
net.ipv4.tcp_max_syn_backlog = 4096

# --- 3. Memory-Safe Buffer Limits (Reduced for 4GB RAM) ---
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216

# TCP: min, default, max
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
net.ipv4.udp_mem = 65536 131072 262144

# --- 4. WebRTC & Passthrough Performance ---
net.core.default_qdisc = fq
net.ipv4.tcp_congestion_control = bbr
net.ipv4.tcp_fastopen = 3
net.ipv4.tcp_slow_start_after_idle = 0
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_fin_timeout = 20

# --- 5. Security & Stability ---
net.ipv4.tcp_syncookies = 1
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.all.accept_redirects = 0
