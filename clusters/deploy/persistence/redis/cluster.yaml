apiVersion: redis.redis.opstreelabs.in/v1beta2
kind: Redis
metadata:
  name: redis-standalone-cluster
  namespace: persistence
spec:
  # Redis image
  kubernetesConfig:
    image: quay.io/opstree/redis:v7.4.7

    # Resources
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

    # Secure redis with password
    redisSecret:
      name: redis-user-secret
      key: password

  # Pod security context
  podSecurityContext:
    runAsUser: 1000
    fsGroup: 1000
  
  # Storage with persistence
  storage:
    volumeClaimTemplate:
      spec:
        accessModes:
          - ReadWriteOnce
        resources:
          requests:
            storage: 5Gi
        storageClassName: linode-block-storage-retain
  
  # Redis configuration
  redisConfig:
    additionalRedisConfig: redis-config
  
  # Redis exporter for monitoring (disabled initially)
  redisExporter:
    enabled: false
    image: quay.io/opstree/redis-exporter:v1.80.2
